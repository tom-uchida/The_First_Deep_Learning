[](2019/05/11)

## 7.1 畳み込みニューラルネットワーク(CNN)の概要
- 畳み込みニューラルネットワーク（以降はCNN）は，ヒトの視覚のように画像認識を得意とする．
- 次の図はCNNの例だが，CNNは画像を入力とした分類問題をよく扱う．
- この図においては，出力層の各ニューロンが各動物に対応し，出力の値がその動物である確率を表す．

<center>
<img src="figures/example_of_cnn.png" width="700">
</center>

- CNNには，畳み込み層，プーロング層，全結合層という名前の層が登場する．
- 例えば，猫の写真を学習済みのCNNに入力すると，90%でネコ，5%でイヌ，3%でウサギ，1%でネズミ，のようにその物体が何である確率が最も高いかを教えてくれる．

<br>

- CNNには，画像を柔軟に精度よく認識するために，通常のニューラルネットワークとは異なる仕組みが備わる．
- 畳み込み層では，出力が入力の一部の影響しか受けない局所性の強い処理がおこなわれる．
- また，プーリング層においては，認識する対象の位置に柔軟に対応できる仕組みが備わる．

<br>

### 7.1.2 CNNの構造
- 複数の層で構成されている点はこれまでに扱ったニューラルネットワークと同様．
- <u>CNNの場合は，層に畳み込み層，プーリング層，全結合層の3種類がある．</u>
- <u>画像は，畳み込み層に入力されるが，畳み込み層とプーリング層は何度か繰り返されて，全結合層につながる．</u>
- 全結合層も何度か繰り返されて，最後の全結合層は出力層になる．

<br>

- 畳み込み層では，入力された画像に対して複数のフィルタ処理をおこない，画像の特徴を表す複数の画像に変換する．</u>
- <u>プーリング層では，画像の特徴を損なわないように画像のサイズを縮小する処理をおこなう．</u>
- 全結合層では，これまで扱ってきたニューラルネットワークの層と同じように，層間のすべてのニューロンが接続される．

<br>

### 7.1.3 畳み込み層
- 画像に対して畳み込みをおこなうことで，画像のある特徴を強めたり弱めたりすることができる．
- <u>畳み込み層では，この畳込み処理により，入力画像をより特徴が強調されたものに変換する．</u>

<br>

- また，画像には局所性という性質がある．
- <u>局所性とは，各ピクセルが近傍のピクセルと強い関連性を持っている性質のこと．</u>
- 例えば，ある隣り合ったピクセル同士は似たような色になる可能性が高く，複数のピクセルからなるかたまりが物体の輪郭を構成することもある．
- <u>畳み込み層は，このような画像の局所性を利用して画像の特徴を抽出する．</u>

<br>

- 畳み込み層では，複数のフィルタを用いて特徴の抽出がおこなわれる．
- 次の図に，畳み込み層における，フィルタを用いた畳込み処理の例を示す：

<center>
<img src="figures/example_of_convolution_process.png" width="700">
</center>

- 畳み込みでは，フィルタを入力画像の各位置にずらして，重なったピクセル同士の値を掛け合わせる．
- そして掛け合わせた値を位置ごとに足し合わせて，新たなピクセルとする．
- 結果として，畳み込みにより3×3の新たな画像が生成される．

<br>

- 畳み込みをおこなうと，元の画像よりもサイズが小さくなる．
- 上記の例では，4×4の画像に2×2のフィルタをかけて3×3の画像が生成されている．

<br>

- 実用的なCNNでは，次のように複数のチャンネルを持つ画像に対して複数のフィルタを用いた畳み込みをおこなう：

<center>
<img src="figures/convolution_for_RGB_image.png" width="700">
</center>

- チャンネル数は3でフィルタの数は4だが，各フィルタは入力画像と同じだけのチャンネル数を持っている．
- 例えば，入力画像がRGBであれば，各フィルタにはそれぞれ3つのチャンネルが必要になる．
- <u>各フィルタにおいて，チャンネルごとに畳み込みをおこない３つの画像を得るが，これらの画像の各ピクセルを足し合わせて1つの画像にする．</u>
- フィルタごとにこの処理をおこなった結果，生成される画像の枚数はフィルタの数と同じになる．

<br>

- <u>畳み込みにより生成された画像の各ピクセルには，バイアスを足して活性化関数で処理する．</u>
- <u>なお，バイアスは，1つのフィルタあたり1つの値をとる．</u>
- <u>すなわち，フィルタの数とバイアスの数は同じになる．</u>

<center>
<img src="figures/overview_of_convolution_layer.png" width="800">
</center>

- <u>この場合，チャンネル数が3の画像を畳み込み層に入力して，チャンネル数が4の画像を出力として得ている．</u>
- <u>畳み込みをおこなっているので，ここの画像のサイズは小さくなっている．</u>
- このような出力画像を，プーリング層や全結合層，あるいは他の畳み込み層に入力することになる．

<br>

- 次は，畳み込み層と全結合層のイメージの比較：

<center>
<img src="figures/comparison_of_convolution_layer_and_fully_connected_layer.png" width="700">
</center>

- <u>畳み込み層はフィルタごとに処理をおこなうため，全結合層と比べて層間の接続が局所的．</u>
- 局所的な特徴を捉えるのに適したネットワーク構造となっている．

<br>


### 7.1.4 プーリング層

<br>

### 7.1.5 全結合層

<br>

### 7.1.6 パディング

<br>

### 7.1.7 ストライド